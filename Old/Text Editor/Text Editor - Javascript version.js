(function(){
    var title = "Text Editor";
    var text = window.getSelection();
    var html = '<!DOCTYPE html><html><head><meta charset=UTF-8><title>'+title+'</title><style>html,body,div,span,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,abbr,address,cite,code,del,dfn,em,img,ins,kbd,q,samp,small,strong,sub,sup,var,b,i,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,figcaption,figure,footer,header,hgroup,menu,nav,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:0 0}body{line-height:1}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}nav ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:"";content:none}a{margin:0;padding:0;font-size:100%;vertical-align:baseline;background:0 0}ins{background-color:#ff9;color:#000;text-decoration:none}mark{background-color:#ff9;color:#000;font-style:italic;font-weight:700}del{text-decoration:line-through}abbr[title],dfn[title]{border-bottom:1px dotted;cursor:help}table{border-collapse:collapse;border-spacing:0}hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:1em 0;padding:0}input,select{vertical-align:middle}body,html{height:100%}body{box-sizing:border-box;font:2rem/1.4 "Trebuchet MS",Helvetica,sans-serif;margin:0}div#title{height:4rem;font-size:3rem;margin-left:2rem;overflow:hidden;text-overflow:ellipsis}input#edit{font:3rem "Trebuchet MS",Helvetica,sans-serif;padding:0;height:3rem;margin:.45rem 0 0 1.9rem}div#notepad{box-sizing:border-box;position:absolute;top:0;bottom:0;margin-top:4rem;width:100%;padding:1rem 2rem 0 2rem;overflow-y:scroll;border-top:2px solid #CCC;word-break:break-all}</style><body><div id=title>'+title+'</div><div contenteditable="" id=notepad>'+text+'</div><script>!function(){function e(e){13==e.keyCode&&t()}function t(){var e=document.getElementById("edit");n.innerHTML=e.value,document.title=e.value,e.removeEventListener("blur",t),e.parentNode.removeChild(e),n.style.display="block"}document.getElementById("notepad").focus(),window.onbeforeunload=function(){return""!==document.getElementById("notepad").textContent.trim()?"Navigating away from this page will remove all notes. Are you sure?":void 0};var n=document.getElementById("title");n.addEventListener("click",function(){var o=document.createElement("input");o.id="edit",o.value=n.innerHTML,n.parentNode.insertBefore(o,n),n.style.display="none",o.addEventListener("blur",t),o.addEventListener("keydown",e),o.focus()})}();</script>';

    window.open('data:text/html,' + encodeURIComponent(html),'_blank');
}) ();